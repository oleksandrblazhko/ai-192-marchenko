## Варіант 18

## Узагальнення

На цьому етапі тестувальники перевіряють, чи додаток автоматично виводить користувача з системи, коли він не діє протягом певного часу, гарантуючи, що неможливо "повторно використовувати" той самий сеанс і що жодні конфіденційні дані не залишаються в кеші браузера.

Всі програми повинні реалізовувати тайм-аут простою або неактивності для сеансів. Цей таймаут визначає час, протягом якого сеанс буде залишатися активним за відсутності активності з боку користувача, закриваючи та анулюючи сеанс після визначеного періоду простою з моменту останнього HTTP-запиту, отриманого веб-додатком для даного ідентифікатора сеансу. Найбільш підходящий таймаут повинен бути балансом між безпекою (коротший таймаут) і зручністю використання (довший таймаут) і значною мірою залежить від рівня чутливості даних, що обробляються додатком. Наприклад, 60-хвилинний час виходу з системи для публічного форуму може бути прийнятним, але такий тривалий час буде занадто довгим для програми домашнього банкінгу (де рекомендується максимальний таймаут 15 хвилин). У будь-якому випадку, будь-який додаток, який не забезпечує вихід з системи після закінчення таймауту, слід вважати незахищеним, якщо тільки така поведінка не вимагається конкретними функціональними вимогами.

Тайм-аут простою обмежує шанси зловмисника вгадати і використати дійсний ідентифікатор сеансу іншого користувача, і за певних обставин може захистити загальнодоступні комп'ютери від повторного використання сеансу. Однак, якщо зловмисник може перехопити сеанс, таймаут очікування не обмежує його дії, оскільки він може періодично генерувати активність у сеансі, щоб підтримувати сеанс активним протягом більш тривалого часу.

Управління тайм-аутом сеансу та його закінченням повинно здійснюватися на стороні сервера. Якщо деякі дані, контрольовані клієнтом, використовуються для примусового завершення сеансу, наприклад, значення файлів cookie або інші параметри клієнта для відстеження часових посилань (наприклад, кількість хвилин з моменту входу в систему), зловмисник може маніпулювати цими даними для продовження тривалості сеансу. Тому програма повинна відстежувати час бездіяльності на стороні сервера і після закінчення таймауту автоматично анулювати сеанс поточного користувача і видаляти всі дані, що зберігаються на клієнті.

Обидві дії повинні бути реалізовані ретельно, щоб уникнути вразливостей, які можуть бути використані зловмисником для отримання несанкціонованого доступу, якщо користувач забув вийти з програми. Зокрема, що стосується функції виходу з системи, важливо переконатися, що всі маркери сеансу (наприклад, файли cookie) належним чином знищуються або стають непридатними для використання, а також забезпечити належний контроль на стороні сервера, щоб запобігти повторному використанню маркерів сеансу. Якщо такі дії не виконуються належним чином, зловмисник може відтворити ці маркери сеансу, щоб "воскресити" сеанс легітимного користувача і видати себе за нього (ця атака зазвичай відома як "відтворення файлів cookie"). Звичайно, пом'якшувальною обставиною є те, що зловмисник повинен мати доступ до цих маркерів (які зберігаються на комп'ютері жертви), але в ряді випадків це не є неможливим або особливо складним завданням.

Найпоширенішим сценарієм для такого роду атак є публічний комп'ютер, який використовується для доступу до певної приватної інформації (наприклад, веб-пошти, банківського рахунку в Інтернеті). Якщо користувач відходить від комп'ютера без явного виходу з системи, а в додатку не реалізовано тайм-аут сеансу, то зловмисник може отримати доступ до того ж облікового запису, просто натиснувши кнопку "Назад" у браузері.

## Цілі тестування
- Перевірити, чи існує жорсткий таймаут сеансу.

## Як тестувати

### Тест Чорної коробки

Той самий підхід, що описаний у розділі "Тестування функціональності виходу з системи", може бути застосований при вимірюванні таймауту виходу з системи. Методологія тестування дуже схожа. По-перше, тестувальники повинні перевірити, чи існує таймаут, наприклад, увійшовши в систему і дочекавшись, поки не спрацює функція виходу по таймауту. Як і у випадку з функцією виходу з системи, після закінчення таймауту всі токени сеансу повинні бути знищені або стати непридатними для використання.

Потім, якщо таймаут налаштовано, тестувальникам потрібно зрозуміти, хто саме застосовує таймаут - клієнт чи сервер (або обидва). Якщо сесійний файл cookie непостійний (або, в більш загальному випадку, сесійний файл cookie не зберігає ніяких даних про час), тестувальники можуть припустити, що таймаут встановлюється сервером. Якщо сесійний файл cookie містить деякі дані, пов'язані з часом (наприклад, час входу в систему, час останнього доступу або дату закінчення терміну дії для постійного файлу cookie), то цілком можливо, що клієнт бере участь у дотриманні таймауту. У цьому випадку тестувальники можуть спробувати змінити файл cookie (якщо він не є криптографічно захищеним) і подивитися, що станеться з сесією. Наприклад, тестувальники можуть встановити дату закінчення терміну дії файлу cookie в далекому майбутньому і подивитися, чи можна буде продовжити сесію.

Як загальне правило, все повинно бути перевірено на стороні сервера, і не повинно бути можливості, повторно встановивши сесійні файли cookie на попередні значення, знову отримати доступ до додатку.

### Тест Сірої коробки

Тестувальник повинен це перевірити:

- Функція виходу з системи ефективно знищує всі токени сеансу або, принаймні, робить їх непридатними для використання,
- Сервер виконує належні перевірки стану сеансу, не дозволяючи зловмиснику відтворити раніше знищені ідентифікатори сеансу
- Встановлюється таймаут, який належним чином виконується сервером. Якщо сервер використовує час закінчення терміну дії, який зчитується з токену сеансу, що надсилається клієнтом (але це не рекомендується), то токен повинен бути криптографічно захищений від підробки.

Зауважте, що найважливіше, щоб програма могла визнати сеанс недійсним на стороні сервера. Зазвичай це означає, що код повинен викликати відповідні методи, наприклад, _**HttpSession.invalidate()**_ в Java і _**Session.abandon()**_ в .NET. Очищення файлів cookie в браузері є бажаним, але не обов'язковим, оскільки якщо сесія буде належним чином анульована на сервері, наявність файлів cookie в браузері не допоможе зловмиснику.
